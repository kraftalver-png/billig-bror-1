<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billig Bror - Med Kart</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        :root {
            --primary: #2ecc71;
            --dark: #1e1e1e;
            --card-bg: #2c2c2c;
            --text: #ffffff;
            --gray: #95a5a6;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--dark);
            color: var(--text);
            padding-bottom: 80px;
        }

        /* HEADER */
        header {
            background: rgba(0,0,0,0.9);
            padding: 15px;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid #333;
            text-align: center;
        }

        h1 { margin: 0; font-size: 22px; color: var(--primary); text-transform: uppercase; letter-spacing: 1px; }

        /* LOCATION SELECTOR */
        .location-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 10px;
            background: #252525;
        }

        .loc-btn {
            background: transparent;
            border: 1px solid #555;
            color: #ccc;
            padding: 8px 14px;
            border-radius: 20px;
            cursor: pointer;
            transition: 0.3s;
            font-size: 14px;
        }

        .loc-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: #000;
            font-weight: bold;
        }

        /* MAP STYLE */
        #map {
            height: 250px; /* H칮yde p친 kartet */
            width: 100%;
            border-bottom: 2px solid var(--primary);
        }

        /* OFFER GRID */
        .container {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        .section-title { margin-bottom: 15px; font-size: 14px; color: var(--gray); text-transform: uppercase; }

        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        /* PRODUCT CARD */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            position: relative;
        }

        .card-img {
            width: 90px;
            background: #eee;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 35px;
        }

        .card-content {
            padding: 12px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .store-logo {
            position: absolute;
            top: 10px;
            right: 10px;
            height: 20px; /* Justert for logoer */
            background: white;
            padding: 4px;
            border-radius: 4px;
            object-fit: contain;
        }

        .product-name { font-size: 16px; font-weight: bold; margin-bottom: 4px; }
        
        .price-container { display: flex; align-items: baseline; gap: 8px; }
        .new-price { font-size: 20px; color: var(--primary); font-weight: bold; }
        .old-price { text-decoration: line-through; color: var(--gray); font-size: 12px; }
        
        .discount-badge {
            display: inline-block;
            background: #e74c3c;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            margin-top: 4px;
            width: fit-content;
        }
    </style>
</head>
<body>

    <header>
        <h1>Billig Bror</h1>
    </header>

    <div class="location-container">
        <button class="loc-btn active" onclick="changeLocation('Gj칮vik')">Gj칮vik</button>
        <button class="loc-btn" onclick="changeLocation('Hamar')">Hamar</button>
        <button class="loc-btn" onclick="changeLocation('Lillehammer')">Lillehammer</button>
    </div>

    <div id="map"></div>

    <div class="container">
        <div class="section-title">Aktuelle tilbud i <span id="city-name" style="color:white">Gj칮vik</span></div>
        <div id="offer-grid" class="grid">
            </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    // --- LOGO URLER (Sikre lenker til SVG filer) ---
    const logos = {
        'Extra': 'https://upload.wikimedia.org/wikipedia/commons/f/fb/Coop_Extra_logo.svg',
        'Rema 1000': 'https://upload.wikimedia.org/wikipedia/commons/8/85/Rema_1000_Logo.svg',
        'Kiwi': 'https://upload.wikimedia.org/wikipedia/commons/e/e8/Kiwi_Minipris_Logo.svg',
        'Meny': 'https://upload.wikimedia.org/wikipedia/commons/d/dc/Meny_Logo.svg'
    };

    // --- DATA ---
    // Inkluderer koordinater (lat/lng) for butikkene for 친 vise p친 kartet
    const offersData = [
        // GJ칒VIK (Koordinater er ca. sentrum/butikkplasseringer)
        { city: 'Gj칮vik', store: 'Extra', product: 'Godt & Blandet', price: 30, oldPrice: 49, emoji: '游꼷', lat: 60.796, lng: 10.685 },
        { city: 'Gj칮vik', store: 'Rema 1000', product: 'Kj칮ttdeig 400g', price: 45, oldPrice: 65, emoji: '游볼', lat: 60.790, lng: 10.695 },
        { city: 'Gj칮vik', store: 'Kiwi', product: 'Grandiosa', price: 29, oldPrice: 59, emoji: '游꼣', lat: 60.800, lng: 10.680 },
        
        // HAMAR
        { city: 'Hamar', store: 'Kiwi', product: 'Sm친godt (hg)', price: 9, oldPrice: 16, emoji: '游꼸', lat: 60.794, lng: 11.068 },
        { city: 'Hamar', store: 'Extra', product: 'Norvegia Ost', price: 89, oldPrice: 129, emoji: '游', lat: 60.798, lng: 11.075 },
        { city: 'Hamar', store: 'Rema 1000', product: 'Coca Cola 4pk', price: 79, oldPrice: 119, emoji: '游볷', lat: 60.791, lng: 11.060 },

        // LILLEHAMMER
        { city: 'Lillehammer', store: 'Meny', product: 'Entrec칪te', price: 199, oldPrice: 359, emoji: '游볼', lat: 61.115, lng: 10.466 },
        { city: 'Lillehammer', store: 'Extra', product: 'Godt & Blandet', price: 30, oldPrice: 49, emoji: '游꼷', lat: 61.120, lng: 10.470 },
        { city: 'Lillehammer', store: 'Kiwi', product: 'Bleier (Libero)', price: 15, oldPrice: 30, emoji: '游놌', lat: 61.110, lng: 10.460 }
    ];

    // By-koordinater (Hvor kartet skal fokusere)
    const cityCoords = {
        'Gj칮vik': [60.795, 10.691],
        'Hamar': [60.794, 11.067],
        'Lillehammer': [61.115, 10.466]
    };

    let currentCity = 'Gj칮vik';
    let map;
    let markers = [];

    // --- INITIALISERING ---
    function init() {
        // Lag kartet, start i Gj칮vik
        map = L.map('map').setView(cityCoords['Gj칮vik'], 13);

        // Legg til kart-fliser (OpenStreetMap - Gratis alternativ til Google Maps)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        // Vis innhold
        renderContent();
    }

    // --- OPPDATER INNHOLD ---
    function changeLocation(city) {
        currentCity = city;
        document.getElementById('city-name').innerText = city;
        
        // Oppdater knapper
        document.querySelectorAll('.loc-btn').forEach(btn => {
            btn.classList.toggle('active', btn.innerText === city);
        });

        renderContent();
    }

    function renderContent() {
        const grid = document.getElementById('offer-grid');
        grid.innerHTML = '';
        
        // Fjern gamle mark칮rer fra kartet
        markers.forEach(m => map.removeLayer(m));
        markers = [];

        // Flytt kartet til valgt by
        map.flyTo(cityCoords[currentCity], 13, { duration: 1.5 });

        // Filtrer tilbud
        const offers = offersData.filter(o => o.city === currentCity);

        if (offers.length === 0) {
            grid.innerHTML = '<p style="text-align:center; color:#777;">Ingen tilbud her akkurat n친.</p>';
            return;
        }

        offers.forEach(offer => {
            const discount = Math.round(((offer.oldPrice - offer.price) / offer.oldPrice) * 100);

            // 1. Lag kortet i listen
            const html = `
                <div class="card">
                    <div class="card-img">${offer.emoji}</div>
                    <img src="${logos[offer.store]}" class="store-logo" alt="${offer.store}">
                    <div class="card-content">
                        <div class="product-name">${offer.product}</div>
                        <div class="price-container">
                            <span class="new-price">${offer.price} kr</span>
                            <span class="old-price">${offer.oldPrice} kr</span>
                        </div>
                        <div class="discount-badge">-${discount}%</div>
                    </div>
                </div>
            `;
            grid.innerHTML += html;

            // 2. Legg til mark칮r (pin) p친 kartet for denne butikken
            const marker = L.marker([offer.lat, offer.lng]).addTo(map);
            marker.bindPopup(`<b>${offer.store}</b><br>${offer.product}: ${offer.price} kr`);
            markers.push(marker);
        });
    }

    // Start appen n친r siden er lastet
    init();

</script>
</body>
</html>
